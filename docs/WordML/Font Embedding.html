<?xml version="1.0" encoding="utf-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><head><style><!--

					/*paged media */ div.header {display: none }
					div.footer {display: none } /*@media print { */
					
						div.header {display: block; position: running(header) }
					

					@page { size: A4; margin: 10%; @top-center {
					content: element(header) } @bottom-center {
					content: element(footer) } }


					/*font definitions*/

					/*element styles*/ .del
					{text-decoration:line-through;color:red;}
					
						  .ins {text-decoration:none;background:#c0ffc0;padding:1px;}
						


					/* Word style definitions */
					
 /* TABLE STYLES */ 

 /* PARAGRAPH STYLES */ 
.DocDefaults {display:block;margin-bottom: 4mm;line-height: 115%;font-family: Calibri;font-size: 11.0pt;}
.Normal {display:block;font-family: Calibri;}
.Header {display:block;text-align: right;margin-bottom: 0in;line-height: 100%;}
.ListBullet {display:block;}
.Heading3 {display:block;page-break-after: avoid;margin-top: 0.11in;margin-bottom: 1mm;font-weight: bold;color: #4F81BD;font-family: Cambria;font-size: 13.0pt;}

 /* CHARACTER STYLES */ .DefaultParagraphFont {display:inline;}
.Hyperlink {display:inline;color: #5F5F5F;text-decoration: underline;}


					/* TABLE CELL STYLES */
					--></style><script type="text/javascript">
				
				function toggleDiv(divid){
					if(document.getElementById(divid).style.display == 'none'){
						document.getElementById(divid).style.display = 'block';
					}else{
						document.getElementById(divid).style.display = 'none';
					}
				}
								
			</script></head><body>
  
  <p><a href="index.html" style="font-size:small">[Table of Contents]</a> <a href="Font Embedding.docx" style="font-size:small">[docx version]</a>
  
  <div class="header">
  
  <p class="Header Normal DocDefaults "><span class="DefaultParagraphFont ">WordprocessingML Reference Material</span><span class="DefaultParagraphFont "><span style="white-space:pre-wrap;"> - </span></span><span class="DefaultParagraphFont ">Table</span><span class="DefaultParagraphFont "><span style="white-space:pre-wrap;"> of Contents</span></span></p></div>
  
  <div class="document">
  
  <p class="Heading3 Normal DocDefaults "> <a name="_Toc147895933_1" /><a name="TOCSection221_1" /><span class="DefaultParagraphFont ">Font Embedding</span></p>
  
  <p class="Normal DocDefaults "><span class="DefaultParagraphFont "><span style="white-space:pre-wrap;">Within a WordprocessingML document, </span></span><span class="DefaultParagraphFont ">font embedding</span><span class="DefaultParagraphFont "><span style="white-space:pre-wrap;"> refers to a process in which the some or all of the </span></span><a href="fonts.html"><span class="Hyperlink DefaultParagraphFont ">fonts</span></a><span class="DefaultParagraphFont "><span style="white-space:pre-wrap;"> used in the current document are included in that document such that it can be guaranteed that they are available for use when the document is subsequently opened.</span></span></p>
  
  <p class="Normal DocDefaults "><span class="DefaultParagraphFont "><span style="white-space:pre-wrap;">Embedded </span></span><a href="fonts.html"><span class="Hyperlink DefaultParagraphFont ">fonts</span></a><span class="DefaultParagraphFont "><span style="white-space:pre-wrap;"> are stored in an Embedded Font part within the package.</span></span></p>
  
  <p class="Normal DocDefaults "><span class="DefaultParagraphFont ">When a font is embedded within a WordprocessingML document, it shall be obfuscated to prevent it from being used outside of this document. This obfuscation shall be done using the following algorithm:</span></p>
  
  <p class="ListBullet Normal DocDefaults " style="position: relative; margin-left: 0.5in;text-indent: -0.25in;">•  <span class="DefaultParagraphFont ">Generate a GUID, which will be used and stored as the obfuscation key</span></p>
  
  <p class="ListBullet Normal DocDefaults ">•  <span class="DefaultParagraphFont ">Reverse the order of the bytes in the GUID (i.e. Big Endian ordering)</span></p>
  
  <p class="ListBullet Normal DocDefaults ">•  <span class="DefaultParagraphFont ">XOR the value with the first 32 bytes of the binary: once against 0-15, once against 16-31</span></p>
  
  <p class="ListBullet Normal DocDefaults ">•  <span class="DefaultParagraphFont "><span style="white-space:pre-wrap;">Store the resulting file in the document, and store the obfuscation key in the </span></span><span class="DefaultParagraphFont ">fontKey</span><span class="DefaultParagraphFont "><span style="white-space:pre-wrap;"> attribute</span></span></p>
  
  <p class="Normal DocDefaults "><span class="DefaultParagraphFont ">[</span><span class="DefaultParagraphFont ">Example</span><span class="DefaultParagraphFont ">: Consider a font to be embedded whose first 32 bytes are as follows:</span></p>
  
  <p class="Normal DocDefaults "><span class="DefaultParagraphFont "><img height="29" id="rId8" src="Font Embedding_files/c37b0e45-092d-4e2d-afb5-f7caac12a033image40.png" width="228" /></span></p>
  
  <p class="Normal DocDefaults "><span class="DefaultParagraphFont ">To obfuscate this font for storage:</span></p>
  
  <p class="ListBullet Normal DocDefaults ">•  <span class="DefaultParagraphFont "><span style="white-space:pre-wrap;">Generate a GUID (e.g. </span></span><span class="DefaultParagraphFont ">001B70DC-AA60-4AD5-90EC-18A0948E1EAE</span><span class="DefaultParagraphFont ">)</span></p>
  
  <p class="ListBullet Normal DocDefaults ">•  <span class="DefaultParagraphFont "><span style="white-space:pre-wrap;">Reverse its order (e.g.  </span></span><span class="DefaultParagraphFont ">AE1E8E94-A018-EC90-D54A-60AADC701B00</span><span class="DefaultParagraphFont ">)</span></p>
  
  <p class="ListBullet Normal DocDefaults ">•  <span class="DefaultParagraphFont ">XOR the GUID with the first and second 16 bytes</span></p>
  
  <p class="Normal DocDefaults "><span class="DefaultParagraphFont ">The resulting 32 bytes would be:</span></p>
  
  <p class="Normal DocDefaults "><span class="DefaultParagraphFont "><img height="29" id="rId9" src="Font Embedding_files/c37b0e45-092d-4e2d-afb5-f7caac12a033image41.png" width="228" /></span></p>
  
  <p class="Normal DocDefaults "><span class="DefaultParagraphFont ">end example</span><span class="DefaultParagraphFont ">]</span></p>
  
  <p class="Normal DocDefaults "><span class="DefaultParagraphFont ">To retrieve an obfuscated font for viewing the content of this document only, repeat the procedure above to retrieve the original font.</span></p></div>
  
  
  
  
  
  
  
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-296711-7', 'auto' , {  'allowLinker': true}); ga('send', 'pageview');</script>
  
  </body></html>